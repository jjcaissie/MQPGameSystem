<!DOCTYPE html>

<html>
<head>
    <title> 20 Questions </title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='portrait.css')}}"/>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
</head>

<body>
    <button class="main-menu-button" onclick="promptMainMenu()">Main Menu</button>
    <h2 id = "questionBox" style="background-color: rgba(0,0,0,0.8); font-size: 30px; text-align: center">{{ answer }}</h2>
    <ul>
        <form action="#" method="post" id ="answer-form">
            {% if firstGuess %}
                <input type="text" id="txtUserGuess" style="width: 90%;">
            {% elif secondGuess %}
                <input type="text" id="txtUserGuess" style="width: 90%; display: none;">
                <select id = "cbSecondUserGuess" onchange="cbChangeSecondGuess()">
                    <option value="" disabled selected>List of Characters</option>
                    {% for character in characters %}
                        <option value>{{ character }}</option>
                    {% endfor %}
                </select>
                <select id="cbUserQuestions">
                    <option value="" disabled selected>List of Past Questions</option>
                    {% for key, value in userQuestions.items() %}
                        <option value disabled>{{ value }}</option>
                    {% endfor %}
                </select>
            {% elif promptReplay %}
                <button class="game-button" onclick="setValue('y')" name="submit_button">Yes</button>
                <button class="game-button" onclick="setValue('n')" name="submit_button">No</button>
            {% else %}
                <select id="cbContainer" style="margin-bottom: 50px;">
                    <optgroup label="Physical Characteristics" style="background-color: rgba(50,54,89,1)">
                        <option value="real">Is your character real?</option>
                        <option value="man">Is your character a man?</option>
                        <option value="woman">Is your character a woman?</option>
                        <option value="human">Is your character a human?</option>
                        <option value="american">Is your character American?</option>
                        <option value="transform">Can your character transform into other things?</option>
                    </optgroup>
                    <optgroup label="Occupational Questions" style="background-color: rgba(50,54,89,1)">
                        <option value="job">Does your character have a job?</option>
                        <option value="singer">Is your character a singer?</option>
                        <option value="actor">Is your character an actor?</option>
                        <option value="detective">Is your character a detective?</option>
                        <option value="plumber">Is your character a plumber</option>
                    </optgroup>
                    <optgroup label ="Personality Questions" style="background-color: rgba(50,54,89,1)">
                        <option value="hero">Is your character a hero?</option>
                        <option value="evil">Is your character evil?</option>
                        <option value="mainCharacter">Is your character the main character?</option>
                    </optgroup>
                    <optgroup label="Pop Culture Questions" style="background-color: rgba(50,54,89,1)">
                        <option value="videoGame">Is your character from a videoGame?</option>
                        <option value="movie">Is your character from a movie?</option>
                        <option value="cartoon">Is your character from a cartoon?</option>
                        <option value="book">Is your character from a book?</option>
                        <option value="nintendo">Is your character from Nintendo?</option>
                        <option value="disney">Is your character from Disney?</option>
                        <option value="dreamworks">Is your character from Dreamworks?</option>
                    </optgroup>
                </select>
            {% endif %}
            <p><input type="hidden" name = "question" id = "question" value = ""></p>
            <p><input type="hidden" name = "skip" id = "skip" value = ""></p>
            {% if firstGuess or secondGuess %}
                <button type = button class="game-button" onclick="submitGuess()" name="submit_button">Submit Guess</button>
            {% elif not promptReplay %}
                <button class="game-button" onclick="submitQuestion()" name="submit_button">Submit Question</button>
                <button type = button class="game-button" onclick="promptSkip()">Ready to Guess Character</button>
            {% endif %}
        </form>
        <script>
            //Send value to server
            function setValue(value)
            {
                document.getElementById("question").value = value;
            }

            //Send comboBox value to server
            function submitQuestion()
            {
                comboBox = document.getElementById("cbContainer");
                comboBoxSelected = comboBox.options[comboBox.selectedIndex];
                selectedOption = comboBoxSelected.value;
                setValue(selectedOption);
            }

            //Send user's character guess to server
            function submitGuess()
            {
                userGuess = document.getElementById("txtUserGuess").value
                if(userGuess.trim() !== '')
                {
                    setValue(userGuess)
                    document.getElementById("answer-form").submit();
                }
            }

            //Send user's character guess to server
            function cbChangeSecondGuess()
            {
                comboBox = document.getElementById("cbSecondUserGuess");
                comboBoxSelected = comboBox.options[comboBox.selectedIndex];
                selectedOptionText = comboBoxSelected.text;

                txt = document.getElementById("txtUserGuess");
                txt.value = selectedOptionText;
            }
            
            //Confirm if user wants to go to main menu
            function promptMainMenu()
            {
                if(confirm("Are you sure? Progress will not be saved")==true)
                {
                    window.open('/',"_self");
                }
            }

            //Confirm if user wants to skip the rest of their questions
            function promptSkip()
            {
                if(confirm("Are you sure? You still have questions available")==true)
                {
                    document.getElementById("skip").value = "True"
                    document.getElementById("answer-form").submit();
                }
            }
        </script>
    </ul>
</body>
</html>